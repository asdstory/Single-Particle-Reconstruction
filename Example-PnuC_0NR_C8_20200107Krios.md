# Example - Processing PnuC_0NR_C8_20200106, totally 4525 images

# Step01 - Import images 

Input files: 2020-01-06-PnuC_0NR_C8-leginon-counting-finished-frames/*.tif

Node type: 2D micrographs movies (*.mrcs, *tiff)

# Step02 - Motion correction

## I/O

Input movies STAR file: Import/job003/movies.star

First frame for corrected sum: 1

Last frame for corrected sum: 0 

Pixel size (A): 1.06

Voltage (kV): 300

Dose per frame (e/A2): 1.42

Pre-exposure (e/A2): 0

## Motion

Bfactor: 150

Number of patches X, Y: 5 5

Use RELION's own implementation? Yes

## Running

Number of MPI procs: 100

Number of threads: 2

Submit to queue? Yes

Queue name: multinode



# Step03 - CTF estimation

## I/O

Spherical aberration (mm): 2.7
Voltage (kV): 300 # Because this dataset was collected on Titan Krios, Building 13, under low mag (13kx)
Amplitude contrast: 0.1
Magnified pixel size (Angstrom): 1.06
Amount of astigmastism (A): 100

#Searches

Use as default

#CTFFIND-4.1

Use CTFFIND-4.1? Yes

# Step04 - Particle Picking using GAutomatch

- [ ] cd to the MotionCor results folder generated by RELION (if you do MotionCor using RELION) -> cd to folder 2020... where you can find the *.mrc file

then,

[user@biowulf]$ sinteractive --gres=gpu:k80:1 --mem=20g -c14
[user@biowulf]$ module load gautomatch
[user@cn3144 ~]$ gautomatch --apixM 1.06 --diameter 160 *.mrc 

or,

## Using our own Linux GPU

module load Gautomatch/0.56

Gautomatch --apixM 1.06 --diameter 160 *.mrc

# Step05 - Subset selection, to discard unsatisfied micrographs

## Subsets

Select based on metadata values? Yes

Metadata label for subset selection: rlnCtfMaxResolution

Minimum metadata value: -9999.
Maximum metadata value: 5

## Runnig

Running without submitting to queue.

# Step06 - Import particle files generated by GAutomatch

Input files: *_automatch.star
Node type: 2D/3D particle coordinates (*.box, *_pick.star)

# Step07 - Subset selection 

Select ~200 images to make a subset, then extract particles from these images and do a quick Class2D. After quick Class2D, we can get templates that may used for template-based Autopick. In this way, we can get more accurate particle picking, and thus lower down the requirement for computational capability of following work, e.g. Class2D, Class 3D, which always cost several days for iterations and calcutations.   

# Step08 - Extract Particles

#Extract

Particle box size (pix): 200

Diameter background circle (pix): 180

# Step09 - 2D classfiicaiton

# CTF

Do CTF-correction? Yes
Ignore CTFs until first peak? Yes

# Optimization

Number of classes: 100

Mask diameter (A): 160

# Step10 - Subset selection

Select classes that interested, and save as templates.

# Step11 - Autopicking

Now, it's time to do template-based Auto-picking.

## I/O

Input micrographs for autopick: CtfFind/job005/micrographs_ctf.star

Pixel size in micrographs (A): -1

2D references: Select/job017/class_averages.star

## References

Pixel sieze in references (A): -1

## autopikcing

Picking thresold: 0.8

Minimum inter-particle distanc (A): 100

Maximum stddev noise: 1.1

Minimum avg noise: -0.5

Shrink factor: 1

## Running

Submit to queue? Yes

Queue name: gpu




















